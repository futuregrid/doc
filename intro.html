
<!-- This layout has been taken from http://globus.org/provision/ -->


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>INTRODUCTION &mdash; Cloud Metrics 2.1.3 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Cloud Metrics 2.1.3 documentation" href="index.html" />
    <link rel="next" title="Modules" href="modules.html" />
    <link rel="prev" title="Welcome to Virtual Cluster documentation!" href="index.html" />
 

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-11111']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  </head>
  <body>

<div style="background-image:url('_static/header_bg.png');background-color: black; text-align: left; padding: 10px 10px 15px 35px">
<a href="index.html"><img src="_static/logo_rain.png" border="0" alt="FutureGrid Rain"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Virtual Cluster documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="#">Documentation </a>|&nbsp;</li>
        <li><a href="download.html">Download</a>|&nbsp;</li>
        <li><a href="support.html">Support</a>|&nbsp;</li>
        <li><a href="https://portal.futuregrid.org/">FutureGrid Home</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">INTRODUCTION</a><ul>
<li><a class="reference internal" href="#system-requirements">System requirements</a></li>
<li><a class="reference internal" href="#code-repository">Code Repository</a></li>
<li><a class="reference internal" href="#id1">Introduction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-install">HOW TO INSTALL</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#futuregrid-specific-instalation">FutureGrid Specific Instalation</a><ul>
<li><a class="reference internal" href="#install-without-admin-rights-on-india-futuregrid">Install without admin rights on india futuregrid</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-run">HOW TO RUN</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#create-configuration-file">Create configuration file</a></li>
<li><a class="reference internal" href="#create-a-virtual-cluster">Create a virtual cluster</a></li>
<li><a class="reference internal" href="#save-a-virtual-cluster">Save a virtual cluster</a></li>
<li><a class="reference internal" href="#restore-a-virtual-cluster">Restore a virtual cluster</a></li>
<li><a class="reference internal" href="#shutdown-a-virtual-cluster">Shutdown a virtual cluster</a></li>
<li><a class="reference internal" href="#show-status-of-virtual-cluster-s">Show status of virtual cluster(s)</a></li>
<li><a class="reference internal" href="#list-the-virtual-clusters">List the virtual clusters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-a-simple-mpi-program-on-virtual-cluster">Run a simple MPI program on virtual cluster</a><ul>
<li><a class="reference internal" href="#using-fg-cluster-tool">Using fg-cluster tool</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for-developers-only">FOR DEVELOPERS ONLY</a><ul>
<li><a class="reference internal" href="#generating-the-distribution">Generating the Distribution</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Virtual Cluster documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Modules</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/intro.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
<body style="background-image:url('_static/header_bg.png');background-color: grey;">
</body>

      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>INTRODUCTION<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="system-requirements">
<h2>System requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>euca2ools: verison 1.2</li>
<li>python: version 2.7</li>
<li>virtualenv (optional, if you do not have sudo rights)</li>
</ul>
</div>
<div class="section" id="code-repository">
<h2>Code Repository<a class="headerlink" href="#code-repository" title="Permalink to this headline">¶</a></h2>
<p>Our code and web page is maintained in github</p>
<ul class="simple">
<li>Source: <a class="reference external" href="https://github.com/futuregrid/virtual-cluster">https://github.com/futuregrid/virtual-cluster</a></li>
<li>Documentation: <a class="reference external" href="http://futuregrid.github.com/virtual-cluster">http://futuregrid.github.com/virtual-cluster</a></li>
</ul>
</div>
<div class="section" id="id1">
<h2>Introduction<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Project futuregrid.virtual.cluster is a virtual cluster management
software utilizing openstack resources on FutureGrid. The software
contains several parts that could help users easily manage their
operations to virtual clusters on FutureGrid.</p>
<p>Managment operations include:</p>
<ul class="simple">
<li>Create virtual cluster(s)</li>
<li>Save currently running virtual cluster(s)</li>
<li>Restore saved virtual cluster(s)</li>
<li>Show status of virtual cluster(s)</li>
<li>List brief information of all created clusters</li>
<li>Terminate virtual cluster(s)</li>
<li>Run a simple MPI program</li>
</ul>
</div>
</div>
<div class="section" id="how-to-install">
<h1>HOW TO INSTALL<a class="headerlink" href="#how-to-install" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>We assume that yo do not have super user priviledges on the computer
where you like to install our tool.</p>
<ul>
<li><p class="first"><strong>Step 0:</strong> Prerequisites (not using india.futuregrid.org machines):</p>
<p>In order to make the installation process work smoothly, please make
sure that the computer you like to install our tool has already
installed euca2ools (version 1.2) and Python (version 2.7). If you do
not have those tools or correct version installed. you may install
euca2ools (version 1.2) from</p>
<ul class="simple">
<li><a class="reference external" href="http://eucalyptussoftware.com/downloads/releases/">http://eucalyptussoftware.com/downloads/releases/</a></li>
</ul>
<p>and install python (version 2.7) from</p>
<ul class="simple">
<li><a class="reference external" href="http://python.org">http://python.org</a></li>
</ul>
<p>After you check all the tools with version are correctly installed,
you may proceed with following steps to start installation.</p>
</li>
<li><p class="first"><strong>Step 1: Prerequisites (using india.futuregrid.org machines):</strong></p>
<blockquote>
<div><p>india.futuregrid.org has installed every tools you may need to finish this
installation, so to activate euca2ools (version 1.2) after you login into
india futuregrid machines, just simply do:</p>
<div class="highlight-python"><pre>$ module load euca2ools</pre>
</div>
<p>To activate python 2.7, simply do:</p>
<div class="highlight-python"><pre>$ module load python</pre>
</div>
<p>Those commands will help you load tools with correct version you need
to finish installation. So now you may proceed with following
installation steps.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 2: Download virtualenv</strong></p>
<blockquote>
<div><p>Since you do not have super user priviledges, you need virtualenv in
order to finish the installtion. You may download virtualenv.py by
following command:</p>
<div class="highlight-python"><pre>$ wget https://raw.github.com/pypa/virtualenv/master/virtualenv.py</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 3: Install virtualenv</strong></p>
<blockquote>
<div><p>After you downloaded virtualenv, you can install it by following
command:</p>
<div class="highlight-python"><pre>$ python virtualenv.py --system-site-packages ENV</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 4: Activate virtualenv</strong></p>
<blockquote>
<div><p>After installation of virtualenv, you can activate virtualenv by
following command:</p>
<div class="highlight-python"><pre>$ source ENV/bin/activate</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 5: install the virtual cluster with pip</strong></p>
<blockquote>
<div><p>Once virtualenv is activated, you can use pip to install our tool by
following command:</p>
<div class="highlight-python"><pre>$ ENV/bin/pip install futuregrid.virtual.cluster</pre>
</div>
<p>If you already had our tool installed, and you want to upgrade to
newest version, you can do it by following command:</p>
<div class="highlight-python"><pre>$ ENV/bin/pip install --upgrade futuregrid.virtual.cluster</pre>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="futuregrid-specific-instalation">
<h2>FutureGrid Specific Instalation<a class="headerlink" href="#futuregrid-specific-instalation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-without-admin-rights-on-india-futuregrid">
<h3>Install without admin rights on india futuregrid<a class="headerlink" href="#install-without-admin-rights-on-india-futuregrid" title="Permalink to this headline">¶</a></h3>
<p>Go to the futuregrid portal</p>
<ul class="simple">
<li><a class="reference external" href="https://portal.futuregrid.org/">https://portal.futuregrid.org/</a></li>
</ul>
<p>If you do not have a futuregrid account, please apply for one at link:</p>
<ul class="simple">
<li><a class="reference external" href="https://portal.futuregrid.org/user/register">https://portal.futuregrid.org/user/register</a></li>
</ul>
<p>In order for you to get access to FutureGrid resources, you need to
apply for a portal account and create a Futuregrid project. This is in
detail explained at</p>
<ul class="simple">
<li><a class="reference external" href="https://portal.futuregrid.org/gettingstarted">https://portal.futuregrid.org/gettingstarted</a></li>
</ul>
<p>Do not forget to upload your public key.  (see also
<a class="reference external" href="https://portal.futuregrid.org/generating-ssh-keys-futuregrid-access">https://portal.futuregrid.org/generating-ssh-keys-futuregrid-access</a>)</p>
<p>Once you have a vaild portal account and a valid project, you can go
ahead and use FutureGrid.</p>
<p>Our virtual cluster is best executed on our machine called
india.futuregrid.org</p>
<p>Please log into this machine and follow the steps that we have outlined
in the previous section to install the software and then run it while
following the instaructions from the next section</p>
</div>
</div>
</div>
<div class="section" id="how-to-run">
<h1>HOW TO RUN<a class="headerlink" href="#how-to-run" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>In order to use our tool, you need to obatin nova credentials and
configuration files for FutureGrid system, you can obtain your nova
credentials and configuration files for the FutureGrid systems. These
should have been placed in your home directory on the INDIA
system. Log in with your FutureGrid username (and SSH public key) and
look for a file called &#8216;username&#8217;-nova.zip. If you do not have a
portal and HPC account please create one.  The credential zip file
(username-nova.zip)contains the user keys and rc file .Unzip this
file in your hom e directory. The novarc file contains the necessary
environment variables.</p>
<p>Create your private key by (Recommended: Use your user name as your
private key name):</p>
<div class="highlight-python"><pre>$ euca-add-keypair youruserkey &gt; youruserkey.pem
$ chmod 0600 youruserkey.pem</pre>
</div>
<p>You can also use our tool to create a userkey for you, but you need
to specify the userkey name in confifuration file which is listed
below. The key can be created if you use &#8211;create-key argument before
any subcommands when you first run our tool. For more help see also:</p>
<div class="highlight-python"><pre>$ fg-cluster --help</pre>
</div>
<p>However, this documentation is much more comprehensive than the help message.</p>
<p>NOTE: For more information about nova credentials, you can refer
to tutorial at:</p>
<div class="highlight-python"><pre>* https://portal.futuregrid.org/tutorials/openstack</pre>
</div>
</div>
<div class="section" id="create-configuration-file">
<h2>Create configuration file<a class="headerlink" href="#create-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>You need to create a configuration file which needs to be passed to
this tool for locating necessary files in order to run. You can create
configuration file using text editor, or using an example we provide
to you</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/futuregrid/virtual-cluster/blob/master/etc/futuregrid.cfg">https://github.com/futuregrid/virtual-cluster/blob/master/etc/futuregrid.cfg</a></li>
</ul>
<p>It has the following format:</p>
<div class="highlight-python"><pre>[virtual-cluster]
# Backup file for saving and loading virtual cluster(s)
backup = ~/.futuregrid/virtual-cluster
# Slurm configuration input file
slurm = ~/.futuregrid/slurm.conf.in
# userkey pem file
userkey = ~/PUT-YOUR-USER-NAME.pem
# environment file
enrc = ~/novarc
# program interface
interface = euca2ools</pre>
</div>
<p>You will have to modify the &lt;PUT-YOUR-USER-NAME-HERE&gt; occurrence
within the file with the name that you use to associate your key. The
file is to be placed at ~/.futuregrid/futuregrid.cfg or concatenated
to an already existing futuregrid.cfg file. In order to use different
interface (euca2ools/boto) to run this tool, you can change interface
parameter in the configuration file to achieve that.</p>
<p>NOTE: Please make sure all the files are placed under the location as
you specified in configuration file. You can also find an example of
slurm.conf.in file which is used by configuring SLURM system from</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/futuregrid/virtual-cluster/blob/master/etc/slurm.conf.in">https://github.com/futuregrid/virtual-cluster/blob/master/etc/slurm.conf.in</a></li>
</ul>
<p>You can modify SLURM configuration parameters for your customized
SLURM. But please leave &#8220;controlMachine&#8221; and &#8220;COMPUTE NODES&#8221;
untouched.</p>
<p>After you finished all steps above, you can use our tool to manage
your virtual clusters</p>
</div>
<div class="section" id="create-a-virtual-cluster">
<h2>Create a virtual cluster<a class="headerlink" href="#create-a-virtual-cluster" title="Permalink to this headline">¶</a></h2>
<p>Run following command will create a virtual cluster of given
parameters (command example is given below):</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; run -n &lt;number-of-computation-nodes&gt; -t &lt;instance-type&gt; -i &lt;image-id&gt; -a &lt;cluster-name&gt;</pre>
</div>
<p>Parameters:</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Futuregrid configuration file named futuregrid.cfg.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n</span></kbd></td>
<td>Number of computation nodes.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Instance type.
Instance type includes: m1.tiny, m1.small and m1.large.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-i</span></kbd></td>
<td>Image id. You can obtain image with a commandline tool such as <tt class="docutils literal"><span class="pre">euca-describe-images</span></tt>.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Cluster name.
The virtual cluster name which uniquely identifies your cluster.</td></tr>
</tbody>
</table>
</div></blockquote>
<p>Please note that the number of computation nodes does not include the control node, so the actual number for virtual cluster.
nodes is the number of computations node plus one control node.</p>
<p>For example:</p>
<div class="highlight-python"><pre>$ fg-cluster -f futuregrid.cfg run -n 2 -t m1.small -i ami-0000001d -a mycluster1</pre>
</div>
<p>Virtual cluster info will be saved in backup file specified in
futuregrid configuration file. Note: Cluster name should be different
as other virtual clusters which is running if you want to run multiple
virtual clusters. If you want to use default configure file, you
should put this file at ~/.futuregrid/futuregrid.cfg, then argument -f
can be omitted</p>
</div>
<div class="section" id="save-a-virtual-cluster">
<h2>Save a virtual cluster<a class="headerlink" href="#save-a-virtual-cluster" title="Permalink to this headline">¶</a></h2>
<p>Run following command will save a currently running virtual cluster into one
control image and compute image for later resotre. (Installed softwares and
unfinished jobs will also be saved):</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; checkpoint -c &lt;control-node-bucket&gt; -t &lt;control-node-name&gt; -m &lt;compute-bucket&gt; -e  &lt;compute-name&gt; -a &lt;cluster-name&gt;</pre>
</div>
<p>Parameters:</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Futuregrid configuration file</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c</span></kbd></td>
<td>Control node bucket name. Bucket name which you can identify control image</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-t</span></kbd></td>
<td>Control node image name. Image name which you can use to identify your control image</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-m</span></kbd></td>
<td>Compute node bucket name. Bucket name which you can identify your compute image</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-e</span></kbd></td>
<td>Compute node image name. Image name which you can use to identify your compute image</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Virtual cluster name</td></tr>
</tbody>
</table>
</div></blockquote>
<p>For example:</p>
<div class="highlight-python"><pre>$ fg-cluster -f futuregrid.cfg checkpoint -c myname -t c1.img -m myname -e c2.img -a mycluster1</pre>
</div>
<p>If you successfully upload your control image and compute image, you
can find them in openstack image repository according to the bucker
name and image name you give to them by command:</p>
<div class="highlight-python"><pre>$ euca-describe-images</pre>
</div>
<p>Note: Cluster name should be a name of cluster which is
currently running. Generated image ids (including one control
node image id and one compute image id) will be registered which
are used for later restore.</p>
</div>
<div class="section" id="restore-a-virtual-cluster">
<h2>Restore a virtual cluster<a class="headerlink" href="#restore-a-virtual-cluster" title="Permalink to this headline">¶</a></h2>
<p>Run following command will restore a virtual cluster state including
installed softwares, unfinished jobs which was saved before, so that
you can continue your work from that saved point:</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; restore -a &lt;cluster-name&gt;</pre>
</div>
<p>Parameters:</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Cluster name. The virtual cluster name which uniquely identifies your cluster.</td></tr>
</tbody>
</table>
</div></blockquote>
<p>For example:</p>
<div class="highlight-python"><pre>$ fg-cluster -f futuregrid.cfg restore -a mycluster2</pre>
</div>
<p>Note: Cluster name should be the name of cluster which had been saved
before.  You can check the images you saved, the images you saved will
have the bucket name and image name you specified from checkpoint command,
and which can be shown by following command:</p>
<div class="highlight-python"><pre>$ euca-describe-images</pre>
</div>
</div>
<div class="section" id="shutdown-a-virtual-cluster">
<h2>Shutdown a virtual cluster<a class="headerlink" href="#shutdown-a-virtual-cluster" title="Permalink to this headline">¶</a></h2>
<p>Run following command will terminate a virtual cluster:</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; terminate -a &lt;cluster-name&gt;</pre>
</div>
<p>Parameters:</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Futuregrid configuration file</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Virtual cluster name</td></tr>
</tbody>
</table>
</div></blockquote>
<p>For example:</p>
<div class="highlight-python"><pre>$ fg-cluster -f futuregrid.cfg terminate -a mycluster2</pre>
</div>
<p>Note: Cluster name should be a name of cluster which is currently
running. After executing this command, cluster info will be removed
from backup file which is specified by configuration file</p>
</div>
<div class="section" id="show-status-of-virtual-cluster-s">
<h2>Show status of virtual cluster(s)<a class="headerlink" href="#show-status-of-virtual-cluster-s" title="Permalink to this headline">¶</a></h2>
<p>Run following command will show status of currently running
virtual cluster(s) including cluster size, image id, instance id, ip:</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; status -a &lt;cluster-name&gt;</pre>
</div>
<p>Parameters:</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Futuregrid configuration file</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Virtual cluster name</td></tr>
</tbody>
</table>
</div></blockquote>
<p>For example:</p>
<p>Show status of one specific cluster given cluster name:</p>
<div class="highlight-python"><pre>fg-cluster -f futuregrid.cfg status -a mycluster1</pre>
</div>
<p>Show status of all currently running clusters:</p>
<div class="highlight-python"><pre>fg-cluster -f futuregrid.cfg status</pre>
</div>
<p>Note: If argument -a is specified, then name of cluster should be
a cluster that is currently running</p>
</div>
<div class="section" id="list-the-virtual-clusters">
<h2>List the virtual clusters<a class="headerlink" href="#list-the-virtual-clusters" title="Permalink to this headline">¶</a></h2>
<p>Run following command will give you a list of virtual clusters and their status:</p>
<div class="highlight-python"><pre>$ fg-cluster -f &lt;config-file&gt; list</pre>
</div>
<p>For example:</p>
<div class="highlight-python"><pre>$ fg-cluster -f futuregrid.cfg list</pre>
</div>
</div>
</div>
<div class="section" id="run-a-simple-mpi-program-on-virtual-cluster">
<h1>Run a simple MPI program on virtual cluster<a class="headerlink" href="#run-a-simple-mpi-program-on-virtual-cluster" title="Permalink to this headline">¶</a></h1>
<p>A simple MPI version of helloworld can be found at:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/futuregrid/virtual-cluster/blob/master/etc/helloworld.c">https://github.com/futuregrid/virtual-cluster/blob/master/etc/helloworld.c</a></li>
</ul>
<p>You may use this for test purpose.</p>
<p>We assume that you are using helloworld.c from above link. So in order to run this MPI program
on the cluster you created using SLURM system, you can conduct the following steps.</p>
<ul>
<li><p class="first"><strong>Step 1: Copy helloworld.c to HOME directory on each node in virtual cluster</strong></p>
<blockquote>
<div><div class="highlight-python"><pre>$ scp -i &lt;your-userkey-pem-file&gt; helloworld.c ubuntu@&lt;instance-ip&gt;:~/</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 2: Login to instances, complie helloworld.c on each node, run</strong></p>
<blockquote>
<div><div class="highlight-python"><pre>$ ssh -i &lt;your-userkey-pem-file&gt; ubuntu@&lt;instance-ip&gt;
$ mpicc hellowrld.c -o helloworld</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 3: run MPI program, you need to login into control node</strong></p>
<blockquote>
<div><p>Option 1: Using salloc command:</p>
<div class="highlight-python"><pre>$ salloc -N 2 mpirun helloworld</pre>
</div>
<p>where -N is the number of computation nodes you want to run with. And
should not be larger than the actual number of computation nodes</p>
<p>Option 2: Using sbatch command by submitting a job script:</p>
<div class="highlight-python"><pre>$ sbatch helloworld.sh</pre>
</div>
<p>You can find example helloworld.sh at</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/futuregrid/virtual-cluster/blob/master/etc/helloworld.sh">https://github.com/futuregrid/virtual-cluster/blob/master/etc/helloworld.sh</a></li>
</ul>
<p>Execution result:</p>
<div class="highlight-python"><pre>Running program helloworld
salloc: Granted job allocation 2
Hello world from processor i-000023c8, rank 0 out of 2 processors
Hello world from processor i-000023c9, rank 1 out of 2 processors
salloc: Relinquishing job allocation 2</pre>
</div>
</div></blockquote>
</li>
</ul>
<div class="section" id="using-fg-cluster-tool">
<h2>Using fg-cluster tool<a class="headerlink" href="#using-fg-cluster-tool" title="Permalink to this headline">¶</a></h2>
<p>A much simpler way to run a MPI program is to use our tool</p>
<p>So you can simply run command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># fg-cluster mpirun -p &lt;program-source-file&gt; -n &lt;compute-nodes-to-use&gt; -a &lt;cluster-name&gt;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># fg-cluster mpirun -p helloworld.c -n 2 -a mycluster1</span>
</pre></div>
</div>
<p>Parameters</p>
<blockquote>
<div><table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-p</span></kbd></td>
<td>Program source code file</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n</span></kbd></td>
<td>Number of computaion nodes you want to run with.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a</span></kbd></td>
<td>Name of virtual cluster you want to run program on</td></tr>
</tbody>
</table>
</div></blockquote>
<p>Make sure that the number you input is no larger than the acutal number of computaion node you created.
The virtual cluster name should be a name of cluster which is currently running.</p>
</div>
</div>
<div class="section" id="for-developers-only">
<h1>FOR DEVELOPERS ONLY<a class="headerlink" href="#for-developers-only" title="Permalink to this headline">¶</a></h1>
<div class="section" id="generating-the-distribution">
<h2>Generating the Distribution<a class="headerlink" href="#generating-the-distribution" title="Permalink to this headline">¶</a></h2>
<p>Assume that you have git correctly installed and configured on your
computer.</p>
<ul>
<li><p class="first"><strong>Step 1: You can pull source code from github by</strong></p>
<blockquote>
<div><div class="highlight-python"><pre>git clone git@github.com:futuregrid/virtual-cluster.git</pre>
</div>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 2: Create tar file for installation</strong></p>
<blockquote>
<div><div class="highlight-python"><pre>make pip</pre>
</div>
<p>This creates the tar file that you can install via pip in ./dist</p>
</div></blockquote>
</li>
<li><p class="first"><strong>Step 3: Install</strong></p>
<blockquote>
<div><div class="highlight-python"><pre>sudo pip install --upgrade dist/*.tar.gz</pre>
</div>
<p>This wil install the files by default into /usr/local/bin/fg-cluster</p>
</div></blockquote>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modules.html" title="Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Virtual Cluster documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="#">Documentation </a>|&nbsp;</li>
        <li><a href="download.html">Download</a>|&nbsp;</li>
        <li><a href="support.html">Support</a>|&nbsp;</li>
        <li><a href="https://portal.futuregrid.org/">FutureGrid Home</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Gregor von Laszewski, Fugang Wang, Hyungro Lee, Javier Diaz.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>